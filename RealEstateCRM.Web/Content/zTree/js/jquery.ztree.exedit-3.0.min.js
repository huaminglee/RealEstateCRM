(function(n){var l=function(n){var t=u.getRoot(n);t.curEditNode=null,t.curEditInput=null,t.curHoverNode=null,t.dragFlag=0,t.dragNodeShowBefore=[],t.dragMaskList=[],t.showHoverDom=!0},a=function(){},v=function(n){var i=n.treeObj,u=t.event;i.unbind(u.RENAME),i.bind(u.RENAME,function(t,i,u){r.apply(n.callback.onRename,[t,i,u])}),i.unbind(u.REMOVE),i.bind(u.REMOVE,function(t,i,u){r.apply(n.callback.onRemove,[t,i,u])}),i.unbind(u.DRAG),i.bind(u.DRAG,function(t,i,u){r.apply(n.callback.onDrag,[t,i,u])}),i.unbind(u.DROP),i.bind(u.DROP,function(t,i,u,f,e){r.apply(n.callback.onDrop,[t,i,u,f,e])})},y=function(n){var c=n.target,s=u.getSetting(n.data.treeId),a=n.relatedTarget,f="",l=null,o="",h=null,i=null;if(r.eqs(n.type,"mouseover")?(i=r.getMDom(s,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i&&(f=i.parentNode.id,o="hoverOverNode")):r.eqs(n.type,"mouseout")?(i=r.getMDom(s,a,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i||(f="remove",o="hoverOutNode")):r.eqs(n.type,"mousedown")&&(i=r.getMDom(s,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i&&(f=i.parentNode.id,o="mousedownNode")),f.length>0){l=u.getNodeCache(s,f);switch(o){case"mousedownNode":h=e.onMousedownNode;break;case"hoverOverNode":h=e.onHoverOverNode;break;case"hoverOutNode":h=e.onHoverOutNode}}return{stop:!1,node:l,nodeEventType:o,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}},p=function(n,t,i){i&&(i.isHover=!1,i.editNameFlag=!1)},w=function(f,e){e.addNodes=function(n,t,u){function s(){i.addNodes(f,n,o,u==!0)}if(!t||(n||(n=null),n&&!n.isParent&&f.data.keep.leaf))return null;var e=f.data.key.childs,o=r.clone(r.isArray(t)?t:[t]);return this.setting.async.enable&&n&&n.isParent&&(!n[e]||n[e].length===0)?i.asyncNode(f,n,u,s):s(),o},e.cancelEditName=function(n){var t=u.getRoot(f),r=f.data.key.name,e=t.curEditNode;t.curEditNode&&i.cancelCurEditNode(f,n?n:e[r])},e.copyNode=function(n,u,e,o){if(!u||n&&!n.isParent&&f.data.keep.leaf&&e===t.move.TYPE_INNER)return null;var h=f.data.key.childs,s=r.clone(u);if(n||(n=null,e=t.move.TYPE_INNER),e==t.move.TYPE_INNER){function c(){i.addNodes(f,n,[s],o)}f.async.enable&&n&&n.isParent&&(!n[h]||n[h].length===0)?i.asyncNode(f,n,o,c):c()}else i.addNodes(f,n.parentNode,[s],o),i.moveNode(f,n,s,e,!1,o);return s},e.editName=function(n){n&&n.tId&&n===u.getNodeCache(f,n.tId)&&r.uCanDo(f)&&(i.expandCollapseParentNode(f,n,!0),i.editNode(f,n))},e.moveNode=function(r,u,e,o){function h(){i.moveNode(f,r,u,e,!1,o)}if(!u)return u;if(r&&!r.isParent&&f.data.keep.leaf&&e===t.move.TYPE_INNER||r&&(u.parentTId==r.tId&&e==t.move.TYPE_INNER||n("#"+u.tId).find("#"+r.tId).length>0))return null;r||(r=null);var s=f.data.key.childs;return f.async.enable&&r&&r.isParent&&(!r[s]||r[s].length===0)?i.asyncNode(f,r,o,h):h(),u},e.removeNode=function(n){n&&r.apply(f.callback.beforeRemove,[f.treeId,n],!0)!=!1&&(i.removeNode(f,n),this.setting.treeObj.trigger(t.event.REMOVE,[f.treeId,n]))},e.removeChilds=function(n){if(!n)return null;var r=f.data.key.childs,t=n[r];return i.removeChilds(f,n),t?t:null},e.setEditable=function(n){return f.edit.enable=n,this.refresh()}},b={setSonNodeLevel:function(n,t,i){var r,f,e;if(i&&(r=n.data.key.childs,i.level=t?t.level+1:0,i[r]))for(f=0,e=i[r].length;f<e;f++)i[r][f]&&u.setSonNodeLevel(n,i,i[r][f])}},e={onHoverOverNode:function(n,t){var r=u.getSetting(n.data.treeId),f=u.getRoot(r);if(f.curHoverNode!=t)e.onHoverOutNode(n);f.curHoverNode=t,i.addHoverDom(r,t)},onHoverOutNode:function(n){var r=u.getSetting(n.data.treeId),t=u.getRoot(r);t.curHoverNode&&!u.isSelectedNode(r,t.curHoverNode)&&(i.removeTreeDom(r,t.curHoverNode),t.curHoverNode=null)},onMousedownNode:function(f,e){function ot(f){var e,ft,b,ot,pt,ai,wt,bt,kt,st,at,ut,ni,vt,yt,lt,li;if(!r.uCanDo(s)||v.dragFlag==0&&Math.abs(ht-f.clientX)<s.edit.drag.minMoveSize&&Math.abs(ct-f.clientY)<s.edit.drag.minMoveSize)return!0;if(ai=s.data.key.childs,r.noSel(s),n("body").css("cursor","pointer"),v.dragFlag==0){if(r.apply(s.callback.beforeDrag,[s.treeId,h],!0)==!1)return rt(f),!0;for(e=0,ft=h.length;e<ft;e++)e==0&&(v.dragNodeShowBefore=[]),b=h[e],b.isParent&&b.open?(i.expandCollapseNode(s,b,!b.open),v.dragNodeShowBefore[b.tId]=!0):v.dragNodeShowBefore[b.tId]=!1;if(v.dragFlag=1,v.showHoverDom=!1,r.showIfameMask(s,!0),wt=!0,bt=-1,h.length>1)for(kt=h[0].parentTId?h[0].getParentNode()[ai]:u.getNodes(s),pt=[],e=0,ft=kt.length;e<ft;e++)if(v.dragNodeShowBefore[kt[e].tId]!==undefined&&(wt&&bt>-1&&bt+1!==e&&(wt=!1),pt.push(kt[e]),bt=e),h.length===pt.length){h=pt;break}for(wt&&(g=h[0].getPreNode(),nt=h[h.length-1].getNextNode()),p=n("<ul class='zTreeDragUL'><\/ul>"),e=0,ft=h.length;e<ft;e++)if(b=h[e],b.editNameFlag=!1,i.selectNode(s,b,e>0),i.removeTreeDom(s,b),ot=n("<li id='"+b.tId+"_tmp'><\/li>"),ot.append(n("#"+b.tId+t.id.A).clone()),ot.css("padding","0"),ot.children("#"+b.tId+t.id.A).removeClass(t.node.CURSELECTED),p.append(ot),e==s.edit.drag.maxShowNodeNum-1){ot=n("<li id='"+b.tId+"_moretmp'><a>  ...  <\/a><\/li>"),p.append(ot);break}p.attr("id",h[0].tId+t.id.UL+"_tmp"),p.addClass(s.treeObj.attr("class")),p.appendTo("body"),y=n("<button class='tmpzTreeMove_arrow'><\/button>"),y.attr("id","zTreeMove_arrow_tmp"),y.appendTo("body"),s.treeObj.trigger(t.event.DRAG,[s.treeId,h])}if(v.dragFlag==1&&y.attr("id")!=f.target.id){c&&(c.removeClass(t.node.TMPTARGET_TREE),a&&n("#"+a+t.id.A,c).removeClass(t.node.TMPTARGET_NODE)),c=null,a=null,k=!1,o=s,st=u.getSettings();for(at in st)st[at].edit.enable&&st[at].treeId!=s.treeId&&(f.target.id==st[at].treeId||n(f.target).parents("#"+st[at].treeId).length>0)&&(k=!0,o=st[at]);var dt=w.scrollTop(),ui=w.scrollLeft(),gt=o.treeObj.offset(),di=o.treeObj.get(0).scrollHeight,gi=o.treeObj.get(0).scrollWidth,fi=f.clientY+dt-gt.top,ei=o.treeObj.height()+gt.top-f.clientY-dt,oi=f.clientX+ui-gt.left,si=o.treeObj.width()+gt.left-f.clientX-ui,vi=fi<s.edit.drag.borderMax&&fi>s.edit.drag.borderMin,yi=ei<s.edit.drag.borderMax&&ei>s.edit.drag.borderMin,pi=oi<s.edit.drag.borderMax&&oi>s.edit.drag.borderMin,wi=si<s.edit.drag.borderMax&&si>s.edit.drag.borderMin,nr=fi>s.edit.drag.borderMin&&ei>s.edit.drag.borderMin&&oi>s.edit.drag.borderMin&&si>s.edit.drag.borderMin,tr=vi&&o.treeObj.scrollTop()<=0,ir=yi&&o.treeObj.scrollTop()+o.treeObj.height()+10>=di,rr=pi&&o.treeObj.scrollLeft()<=0,ur=wi&&o.treeObj.scrollLeft()+o.treeObj.width()+10>=gi;if(f.target.id&&o.treeObj.find("#"+f.target.id).length>0){for(ut=f.target;ut&&ut.tagName&&!r.eqs(ut.tagName,"li")&&ut.id!=o.treeId;)ut=ut.parentNode;for(ni=!0,e=0,ft=h.length;e<ft;e++)if(b=h[e],ut.id===b.tId){ni=!1;break}else if(n("#"+b.tId).find("#"+ut.id).length>0){ni=!1;break}ni&&f.target.id&&(f.target.id==ut.id+t.id.A||n(f.target).parents("#"+ut.id+t.id.A).length>0)&&(c=n(ut),a=ut.id)}if(b=h[0],nr&&(f.target.id==o.treeId||n(f.target).parents("#"+o.treeId).length>0)&&(!c&&(f.target.id==o.treeId||tr||ir||rr||ur)&&(k||!k&&b.parentTId)&&(c=o.treeObj),vi?o.treeObj.scrollTop(o.treeObj.scrollTop()-10):yi&&o.treeObj.scrollTop(o.treeObj.scrollTop()+10),pi?o.treeObj.scrollLeft(o.treeObj.scrollLeft()-10):wi&&o.treeObj.scrollLeft(o.treeObj.scrollLeft()+10),c&&c!=o.treeObj&&c.offset().left<o.treeObj.offset().left&&o.treeObj.scrollLeft(o.treeObj.scrollLeft()+c.offset().left-o.treeObj.offset().left)),p.css({top:f.clientY+dt+3+"px",left:f.clientX+ui+3+"px"}),vt=0,yt=0,c&&c.attr("id")!=o.treeId){var d=a==null?null:u.getNodeCache(o,a),hi=f.ctrlKey&&s.edit.drag.isMove&&s.edit.drag.isCopy||!s.edit.drag.isMove&&s.edit.drag.isCopy,fr=!!(g&&a===g.tId),er=!!(nt&&a===nt.tId),or=b.parentTId&&b.parentTId==a,ti=(hi||!er)&&r.apply(o.edit.drag.prev,[o.treeId,d],!!o.edit.drag.prev),ii=(hi||!fr)&&r.apply(o.edit.drag.next,[o.treeId,d],!!o.edit.drag.next),ci=(hi||!or)&&!(o.data.keep.leaf&&!d.isParent)&&r.apply(o.edit.drag.inner,[o.treeId,d],!!o.edit.drag.inner);if(ti||ii||ci){lt=n("#"+a+t.id.A,c),lt.addClass(t.node.TMPTARGET_NODE);var bi=ti?ci?.25:ii?.5:1:-1,ki=ii?ci?.75:ti?.5:0:-1,ri=(f.clientY+dt-lt.offset().top)/lt.height();(bi==1||ri<=bi&&ri>=-.2)&&ti?(vt=1-y.width(),yt=0-y.height()/2,l=t.move.TYPE_PREV):(ki==0||ri>=ki&&ri<=1.2)&&ii?(vt=1-y.width(),yt=lt.height()-y.height()/2,l=t.move.TYPE_NEXT):(vt=5-y.width(),yt=0,l=t.move.TYPE_INNER),y.css({display:"block",top:lt.offset().top+yt+"px",left:lt.offset().left+vt+"px"}),(tt!=a||it!=l)&&(et=(new Date).getTime()),d&&d.isParent&&l==t.move.TYPE_INNER&&(li=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==d.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===d.tId&&(li=!1),li&&(window.zTreeMoveTimer=setTimeout(function(){l==t.move.TYPE_INNER&&d&&d.isParent&&!d.open&&(new Date).getTime()-et>o.edit.drag.autoOpenTime&&r.apply(o.callback.beforeDragOpen,[o.treeId,d],!0)&&i.switchNode(o,d)},o.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=d.tId))}else c=null,a="",l=t.move.TYPE_INNER,y.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}else l=t.move.TYPE_INNER,c&&r.apply(o.edit.drag.inner,[o.treeId,d],!!o.edit.drag.inner)?c.addClass(t.node.TMPTARGET_TREE):c=null,y.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);tt=a,it=l}return!1}function rt(f){var d,ut,g,ft,nt,b,e;if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),tt=null,it=null,w.unbind("mousemove",ot),w.unbind("mouseup",rt),w.unbind("selectstart",st),n("body").css("cursor","auto"),c&&(c.removeClass(t.node.TMPTARGET_TREE),a&&n("#"+a+t.id.A,c).removeClass(t.node.TMPTARGET_NODE)),r.showIfameMask(s,!1),v.showHoverDom=!0,v.dragFlag!=0){for(v.dragFlag=0,ft=s.data.key.childs,d=0,ut=h.length;d<ut;d++)g=h[d],g.isParent&&v.dragNodeShowBefore[g.tId]&&!g.open&&(i.expandCollapseNode(s,g,!g.open),delete v.dragNodeShowBefore[g.tId]);if(p&&p.remove(),y&&y.remove(),nt=f.ctrlKey&&s.edit.drag.isMove&&s.edit.drag.isCopy||!s.edit.drag.isMove&&s.edit.drag.isCopy,!nt&&c&&a&&h[0].parentTId&&a==h[0].parentTId&&l==t.move.TYPE_INNER&&(c=null),c){if(b=a==null?null:u.getNodeCache(o,a),r.apply(s.callback.beforeDrop,[o.treeId,h,b,l],!0)==!1)return;e=nt?r.clone(h):h;function et(){if(k){if(!nt)for(var r=0,u=h.length;r<u;r++)i.removeNode(s,h[r]);if(l==t.move.TYPE_INNER)i.addNodes(o,b,e);else if(i.addNodes(o,b.getParentNode(),e),l==t.move.TYPE_PREV)for(r=0,u=e.length;r<u;r++)i.moveNode(o,b,e[r],l,!1);else for(r=-1,u=e.length-1;r<u;u--)i.moveNode(o,b,e[u],l,!1)}else if(nt&&l==t.move.TYPE_INNER)i.addNodes(o,b,e);else if(nt&&i.addNodes(o,b.getParentNode(),e),l==t.move.TYPE_PREV)for(r=0,u=e.length;r<u;r++)i.moveNode(o,b,e[r],l,!1);else for(r=-1,u=e.length-1;r<u;u--)i.moveNode(o,b,e[u],l,!1);for(r=0,u=e.length;r<u;r++)i.selectNode(o,e[r],r>0);n("#"+e[0].tId+t.id.ICON).focus().blur()}l==t.move.TYPE_INNER&&o.async.enable&&b&&b.isParent&&(!b[ft]||b[ft].length===0)?i.asyncNode(o,b,!1,et):et(),s.treeObj.trigger(t.event.DROP,[o.treeId,e,b,l])}else{for(d=0,ut=h.length;d<ut;d++)i.selectNode(o,h[d],d>0);s.treeObj.trigger(t.event.DROP,[s.treeId,null,null,null])}}}function st(){return!1}var b,ut,s=u.getSetting(f.data.treeId),v=u.getRoot(s);if(f.button==2||!s.edit.enable||!s.edit.drag.isCopy&&!s.edit.drag.isMove)return!0;var ft=f.target,d=u.getRoot(s).curSelectedList,h=[];if(u.isSelectedNode(s,e))for(b=0,ut=d.length;b<ut;b++){if(d[b].editNameFlag&&r.eqs(ft.tagName,"input")&&ft.getAttribute("treeNode"+t.id.INPUT)!==null)return!0;if(h.push(d[b]),h[0].parentTId!==d[b].parentTId){h=[e];break}}else h=[e];var w=n(document),p,y,c,k=!1,o=s,g,nt,tt=null,it=null,a=null,l=t.move.TYPE_INNER,ht=f.clientX,ct=f.clientY,et=(new Date).getTime();return w.bind("mousemove",ot),w.bind("mouseup",rt),w.bind("selectstart",st),!0}},k={getAbs:function(n){var t=n.getBoundingClientRect();return[t.left,t.top]},inputFocus:function(n){n.get(0)&&(n.focus(),r.setCursorPosition(n.get(0),n.val().length))},setCursorPosition:function(n,t){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},showIfameMask:function(t,i){for(var e=u.getRoot(t),o,f,h;e.dragMaskList.length>0;)e.dragMaskList[0].remove(),e.dragMaskList.shift();if(i)for(o=n("iframe"),f=0,h=o.length;f<h;f++){var s=o.get(f),c=r.getAbs(s),l=n("<div id='zTreeMask_"+f+"' class='zTreeMask' style='background-color:yellow;opacity: 0.3;filter: alpha(opacity=30);    top:"+c[1]+"px; left:"+c[0]+"px; width:"+s.offsetWidth+"px; height:"+s.offsetHeight+"px;'><\/div>");l.appendTo("body"),e.dragMaskList.push(l)}}},d={addEditBtn:function(u,f){if(!f.editNameFlag&&!(n("#"+f.tId+t.id.EDIT).length>0)&&r.apply(u.edit.showRenameBtn,[u.treeId,f],u.edit.showRenameBtn)){var e=n("#"+f.tId+t.id.A),o="<button type='button' class='edit' id='"+f.tId+t.id.EDIT+"' title='"+r.apply(u.edit.renameTitle,[u.treeId,f],u.edit.renameTitle)+"' treeNode"+t.id.EDIT+" onfocus='this.blur();' style='display:none;'><\/button>";e.append(o),n("#"+f.tId+t.id.EDIT).bind("click",function(){return r.uCanDo(u)?(i.editNode(u,f),!1):!0}).show()}},addRemoveBtn:function(u,f){if(!f.editNameFlag&&!(n("#"+f.tId+t.id.REMOVE).length>0)&&r.apply(u.edit.showRemoveBtn,[u.treeId,f],u.edit.showRemoveBtn)){var e=n("#"+f.tId+t.id.A),o="<button type='button' class='remove' id='"+f.tId+t.id.REMOVE+"' title='"+r.apply(u.edit.removeTitle,[u.treeId,f],u.edit.removeTitle)+"' treeNode"+t.id.REMOVE+" onfocus='this.blur();' style='display:none;'><\/button>";e.append(o),n("#"+f.tId+t.id.REMOVE).bind("click",function(){return!r.uCanDo(u)||r.apply(u.callback.beforeRemove,[u.treeId,f],!0)==!1?!0:(i.removeNode(u,f),u.treeObj.trigger(t.event.REMOVE,[u.treeId,f]),!1)}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(n,t){u.getRoot(n).showHoverDom&&(t.isHover=!0,n.edit.enable&&(i.addEditBtn(n,t),i.addRemoveBtn(n,t)),r.apply(n.view.addHoverDom,[n.treeId,t]))},cancelCurEditNode:function(f,e){var s=u.getRoot(f),c=f.data.key.name,o=s.curEditNode,h,l;if(o){if(h=s.curEditInput,e=e?e:h.val(),e!==o[c]){if(r.apply(f.callback.beforeRename,[f.treeId,o,e],!0)===!1)return o.editNameStatus=!0,r.inputFocus(h),!1;o[c]=e?e:h.val(),f.treeObj.trigger(t.event.RENAME,[f.treeId,o])}l=n("#"+o.tId+t.id.A),l.removeClass(t.node.CURSELECTED_EDIT),h.unbind(),i.setNodeName(f,o),o.editNameFlag=!1,s.curEditNode=null,s.curEditInput=null,i.selectNode(f,o,!1)}return s.noSelection=!0,!0},editNode:function(f,e){var s=u.getRoot(f),h,o;u.isSelectedNode(f,e)&&s.curEditNode==e&&e.editNameFlag||(h=f.data.key.name,e.editNameFlag=!0,i.removeTreeDom(f,e),i.cancelCurEditNode(f),i.selectNode(f,e,!1),n("#"+e.tId+t.id.SPAN).html("<input type=text class='rename' id='"+e.tId+t.id.INPUT+"' treeNode"+t.id.INPUT+" >"),o=n("#"+e.tId+t.id.INPUT),o.attr("value",e[h]),r.inputFocus(o),o.bind("blur",function(){i.cancelCurEditNode(f)}).bind("keyup",function(n){n.keyCode=="13"?i.cancelCurEditNode(f):n.keyCode=="27"&&i.cancelCurEditNode(f,e[h])}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),n("#"+e.tId+t.id.A).addClass(t.node.CURSELECTED_EDIT),s.curEditInput=o,s.noSelection=!1,s.curEditNode=e)},moveNode:function(r,f,e,o,s,h){var g=u.getRoot(r),c=r.data.key.childs,l,k,y,p,nt,tt;if(f!=e&&(!r.data.keep.leaf||!f||f.isParent||o!=t.move.TYPE_INNER)){l=e.parentTId?e.getParentNode():g,k=f===null||f==g,k&&f===null&&(f=g),k&&(o=t.move.TYPE_INNER),y=f.parentTId?f.getParentNode():g,o!=t.move.TYPE_PREV&&o!=t.move.TYPE_NEXT&&(o=t.move.TYPE_INNER),k?(p=r.treeObj,nt=p):h||(o==t.move.TYPE_INNER?i.expandCollapseNode(r,f,!0,!1):i.expandCollapseNode(r,f.getParentNode(),!0,!1),p=n("#"+f.tId),nt=n("#"+f.tId+t.id.UL)),tt=n("#"+e.tId).remove(),nt&&o==t.move.TYPE_INNER?nt.append(tt):p&&o==t.move.TYPE_PREV?p.before(tt):p&&o==t.move.TYPE_NEXT&&p.after(tt);var a,it,w=-1,d=0,b=null,v=null,rt=e.level;if(e.isFirstNode)w=0,l[c].length>1&&(b=l[c][1],b.isFirstNode=!0);else if(e.isLastNode)w=l[c].length-1,b=l[c][w-1],b.isLastNode=!0;else for(a=0,it=l[c].length;a<it;a++)if(l[c][a].tId==e.tId){w=a;break}if(w>=0&&l[c].splice(w,1),o!=t.move.TYPE_INNER)for(a=0,it=y[c].length;a<it;a++)y[c][a].tId==f.tId&&(d=a);if(o==t.move.TYPE_INNER?(k?e.parentTId=null:(f.isParent=!0,f.open=!1,e.parentTId=f.tId),f[c]||(f[c]=[]),f[c].length>0&&(v=f[c][f[c].length-1],v.isLastNode=!1),f[c].splice(f[c].length,0,e),e.isLastNode=!0,e.isFirstNode=f[c].length==1):f.isFirstNode&&o==t.move.TYPE_PREV?(y[c].splice(d,0,e),v=f,v.isFirstNode=!1,e.parentTId=f.parentTId,e.isFirstNode=!0,e.isLastNode=!1):f.isLastNode&&o==t.move.TYPE_NEXT?(y[c].splice(d+1,0,e),v=f,v.isLastNode=!1,e.parentTId=f.parentTId,e.isFirstNode=!1,e.isLastNode=!0):(o==t.move.TYPE_PREV?y[c].splice(d,0,e):y[c].splice(d+1,0,e),e.parentTId=f.parentTId,e.isFirstNode=!1,e.isLastNode=!1),u.fixPIdKeyValue(r,e),u.setSonNodeLevel(r,e.getParentNode(),e),i.setNodeLineIcos(r,e),i.repairNodeLevelClass(r,e,rt),!r.data.keep.parent&&l[c].length<1){l.isParent=!1,l.open=!1;var ut=n("#"+l.tId+t.id.UL),ft=n("#"+l.tId+t.id.SWITCH),et=n("#"+l.tId+t.id.ICON);i.replaceSwitchClass(ft,t.folder.DOCU),i.replaceIcoClass(l,et,t.folder.DOCU),ut.css("display","none")}else b&&i.setNodeLineIcos(r,b);v&&i.setNodeLineIcos(r,v),r.checkable&&(i.repairChkClass(r,l),i.repairParentChkClassWithSelf(r,l),l!=e.parent&&i.repairParentChkClassWithSelf(r,e)),h||i.expandCollapseParentNode(r,e.getParentNode(),!0,s)}},removeChilds:function(r,f){var s,e,o,h,c,l;if(f&&(s=r.data.key.childs,e=f[s],e)){for(n("#"+f.tId+t.id.UL).remove(),o=0,h=e.length;o<h;o++)u.removeNodeCache(r,e[o]);u.removeSelectedNode(r),delete f[s],r.data.keep.parent||(f.isParent=!1,f.open=!1,c=n("#"+f.tId+t.id.SWITCH),l=n("#"+f.tId+t.id.ICON),i.replaceSwitchClass(c,t.folder.DOCU),i.replaceIcoClass(f,l,t.folder.DOCU))}},removeEditBtn:function(i){n("#"+i.tId+t.id.EDIT).unbind().remove()},removeNode:function(r,f){var l=u.getRoot(r),o=r.data.key.childs,e=f.parentTId?f.getParentNode():l,c,y,a,s,v,h,p;for(l.curEditNode===f&&(l.curEditNode=null),n("#"+f.tId).remove(),u.removeNodeCache(r,f),u.removeSelectedNode(r,f),c=0,y=e[o].length;c<y;c++)if(e[o][c].tId==f.tId){e[o].splice(c,1);break}!r.data.keep.parent&&e[o].length<1?(e.isParent=!1,e.open=!1,a=n("#"+e.tId+t.id.UL),s=n("#"+e.tId+t.id.SWITCH),v=n("#"+e.tId+t.id.ICON),i.replaceSwitchClass(s,t.folder.DOCU),i.replaceIcoClass(e,v,t.folder.DOCU),a.css("display","none")):r.view.showLine&&e[o].length>0&&(h=e[o][e[o].length-1],h.isLastNode=!0,h.isFirstNode=e[o].length==1,a=n("#"+h.tId+t.id.UL),s=n("#"+h.tId+t.id.SWITCH),v=n("#"+h.tId+t.id.ICON),e==l?e[o].length==1?i.replaceSwitchClass(s,t.line.ROOT):(p=n("#"+e[o][0].tId+t.id.SWITCH),i.replaceSwitchClass(p,t.line.ROOTS),i.replaceSwitchClass(s,t.line.BOTTOM)):i.replaceSwitchClass(s,t.line.BOTTOM),a.removeClass(t.line.LINE))},removeRemoveBtn:function(i){n("#"+i.tId+t.id.REMOVE).unbind().remove()},removeTreeDom:function(n,t){t.isHover=!1,i.removeEditBtn(t),i.removeRemoveBtn(t),r.apply(n.view.removeHoverDom,[n.treeId,t])},repairNodeLevelClass:function(i,r,u){if(u!==r.level){var o=n("#"+r.tId),s=n("#"+r.tId+t.id.A),h=n("#"+r.tId+t.id.UL),f="level"+u,e="level"+r.level;o.removeClass(f),o.addClass(e),s.removeClass(f),s.addClass(e),h.removeClass(f),h.addClass(e)}}},g={tools:k,view:d,event:nt,data:b},o,s,h,c;n.extend(!0,n.fn.zTree.consts,{event:{DRAG:"ztree_drag",DROP:"ztree_drop",REMOVE:"ztree_remove",RENAME:"ztree_rename"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}}),n.extend(!0,n.fn.zTree._z,g);var f=n.fn.zTree,r=f._z.tools,t=f.consts,i=f._z.view,u=f._z.data,nt=f._z.event;u.exSetting({edit:{enable:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeRemove:null,beforeRename:null,onDrag:null,onDrop:null,onRemove:null,onRename:null}}),u.addInitBind(v),u.addInitCache(a),u.addInitNode(p),u.addInitProxy(y),u.addInitRoot(l),u.addZTreeTools(w),o=i.cancelPreSelectedNode,i.cancelPreSelectedNode=function(n,t){for(var f=u.getRoot(n).curSelectedList,r=0,e=f.length;r<e;r++)if((!t||t===f[r])&&(i.removeTreeDom(n,f[r]),t))break;o&&o.apply(i,arguments)},s=i.createNodes,i.createNodes=function(n,t,r,u){(s&&s.apply(i,arguments),r)&&i.repairParentChkClassWithSelf(n,u)},i.makeNodeUrl=function(n,t){return t.url&&!n.edit.enable?t.url:null},h=i.selectNode,i.selectNode=function(n,t){var r=u.getRoot(n);return u.isSelectedNode(n,t)&&r.curEditNode==t&&t.editNameFlag?!1:(h&&h.apply(i,arguments),i.addHoverDom(n,t),!0)},c=r.uCanDo,r.uCanDo=function(n,t){var f=u.getRoot(n);return t&&(r.eqs(t.type,"mouseover")||r.eqs(t.type,"mouseout")||r.eqs(t.type,"mousedown")||r.eqs(t.type,"mouseup"))?!0:!f.curEditNode&&(c?c.apply(i,arguments):!0)}})(jQuery);
//@ sourceMappingURL=jquery.ztree.exedit-3.0.min.js.map